{"version":3,"sources":["webpack:///./client/components/data-manage/excel-data.vue?65b0","webpack:///client/components/data-manage/excel-data.vue","webpack:///./client/components/data-manage/excel-data.vue?676d","webpack:///./client/components/data-manage/excel-data.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","staticRenderFns","name","data","xs","fileid","exceldata","mounted","$route","query","id","getFileById","created","methods","$API","getDataById","res","body","init","mode","showToolbar","showGrid","showContextmenu","view","height","width","bottombar","el","hide","watch","box","length","remove","component"],"mappings":"yHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,UAAUC,MAAM,CAAC,GAAK,yBACxIC,EAAkB,G,wBCQtB,8BACA,OACEC,KAAM,aACNC,KAFF,WAGI,MAAO,CACLC,GAAI,KACJC,OAAQ,GACRC,UAAW,CACTJ,KAAM,GACNC,KAAM,MAIZI,QAZF,WAaIb,KAAKW,OAASX,KAAKc,OAAOC,MAAMC,GAChChB,KAAKiB,YAAYjB,KAAKW,SAExBO,QAhBF,aAiBEC,QAAS,CAEPF,YAFJ,SAEA,cACMjB,KAAKoB,KAAKC,YAAY,CAA5B,0BAEwB,MAAZC,EAAIC,MACN,EAAV,sBAIIC,KAVJ,SAUA,GACM,IAAN,8CACA,oBACA,mBACMxB,KAAKU,GAAK,IAAI,EAApB,4BACQe,KAAM,OACNC,aAAa,EACbC,UAAU,EACVC,iBAAiB,EACjBC,KAAM,CACJC,OAAQ,WAAlB,aACUC,MAAO,WAAjB,aAEA,YAIM/B,KAAKU,GAAGsB,UAAUC,GAAGC,SAWzBC,MAAO,CACLrB,OADJ,WAGM,IAAN,mDACwB,GAAdsB,EAAIC,QACND,EAAI,GAAGE,SAETtC,KAAKW,OAASX,KAAKc,OAAOC,MAAMC,GAChChB,KAAKiB,YAAYjB,KAAKW,WCzEuU,I,YCO/V4B,EAAY,eACd,EACAzC,EACAS,GACA,EACA,KACA,WACA,MAIa,aAAAgC,E","file":"static/js/chunk-2d0bd793.f3066d5a.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"x-sheet\",attrs:{\"id\":\"x-spreadsheet-demo\"}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <!--web spreadsheet组件-->\r\n  <div id=\"x-spreadsheet-demo\" class=\"x-sheet\"></div>\r\n</template>\r\n\r\n<script>\r\nimport Spreadsheet from \"x-data-spreadsheet\";\r\nimport zhCN from \"x-data-spreadsheet/src/locale/zh-cn\";\r\n//设置中文\r\nSpreadsheet.locale(\"zh-cn\", zhCN);\r\nexport default {\r\n  name: \"excel-data\",\r\n  data() {\r\n    return {\r\n      xs: null,\r\n      fileid: \"\",\r\n      exceldata: {\r\n        name: \"\",\r\n        data: [],\r\n      },\r\n    };\r\n  },\r\n  mounted() {\r\n    this.fileid = this.$route.query.id;\r\n    this.getFileById(this.fileid);\r\n  },\r\n  created() {},\r\n  methods: {\r\n    //从mongodb数据库拿数据\r\n    getFileById(val) {\r\n      this.$API.getDataById({ _id: val }).then((res) => {\r\n        // console.log(res.body);\r\n        if (res.body != null) {\r\n          this.init(res.body.data);\r\n        }\r\n      });\r\n    },\r\n    init(val) {\r\n      let div = document.getElementsByClassName(\"dataPage\");\r\n      let h = div[0].offsetHeight;\r\n      let w = div[0].offsetWidth;\r\n      this.xs = new Spreadsheet(\"#x-spreadsheet-demo\", {\r\n        mode: \"read\",\r\n        showToolbar: false,\r\n        showGrid: true,\r\n        showContextmenu: false,\r\n        view: {\r\n          height: () => h - 25,\r\n          width: () => w,\r\n        },\r\n      }).loadData(val);\r\n      // .change((cdata) => {\r\n      //   console.log(\">>>\", cdata);\r\n      // });\r\n      this.xs.bottombar.el.hide();\r\n    },\r\n    //删除数据\r\n    // deleteData() {\r\n    //   this.$API.deleteData({ _id: this.fileid }).then(() => {\r\n    //     this.$message.success(\"删除成功\");\r\n    //     this.$router.replace(\"/home/page-data/excel-data\");\r\n    //   });\r\n    // .catch(() => {});\r\n    // },\r\n  },\r\n  watch: {\r\n    $route() {\r\n      //监听路由变化则更新\r\n      let box = document.getElementsByClassName(\"x-spreadsheet\");\r\n      if (box.length != 0) {\r\n        box[0].remove();\r\n      }\r\n      this.fileid = this.$route.query.id;\r\n      this.getFileById(this.fileid);\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./excel-data.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./excel-data.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./excel-data.vue?vue&type=template&id=db411d54&scoped=true&\"\nimport script from \"./excel-data.vue?vue&type=script&lang=js&\"\nexport * from \"./excel-data.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"db411d54\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}